labels=c('Emotional','Perceptual'), name='Oddball List Type')+
scale_y_continuous(labels = scales::number_format(accuracy = 0.01))
pltCRP
# Transitions from oddballs
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
TFCRP<-read.csv('ToFrom_CRP_R.csv')
TFCRP<-as.data.frame(TFCRP)
#head(TFCRP) #to show you what my raw data looks like
TFplot<-TFCRP %>%
group_by(oddballtype,wordposition, direction,transition) %>%
get_summary_stats(CRP,type='mean_ci')
wpplot<-numeric(0)
for (rows in 1:nrow(TFplot)){
if (TFplot$direction[rows] == "Backwards") {
wpplot[rows]<-(TFplot$wordposition[rows])*-1
}
else {wpplot[rows]<-(TFplot$wordposition[rows])
}
}
invisible(as.data.frame(wpplot))
TFplot$wpplot<-wpplot
TFplot$transition<-factor(TFplot$transition, levels=c('to','from'))
transition.labs<- c('Transition TO the oddball', 'Transition FROM the oddball')
names(transition.labs)<-c('to', 'from')
TFplot <- filter(TFplot, transition == 'from')
TFplot <- droplevels(TFplot)
# Transitions from controls
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP/Raw_Results")
TFCRPctrl<-read.csv('control_ToFrom_CRP_R.csv')
TFCRPctrl<-as.data.frame(TFCRPctrl)
#head(TFCRP) #to show you what my raw data looks like
ctrlTFplot<-TFCRPctrl %>%
group_by(oddballtype,wordposition, direction,transition) %>%
get_summary_stats(CRP,type='mean_ci')
ctrlwpplot<-numeric(0)
for (rows in 1:nrow(ctrlTFplot)){
if (ctrlTFplot$direction[rows] == "Backwards") {
ctrlwpplot[rows]<-(ctrlTFplot$wordposition[rows])*-1
}
else {ctrlwpplot[rows]<-(ctrlTFplot$wordposition[rows])
}
}
invisible(as.data.frame(ctrlwpplot))
ctrlTFplot$ctrlwpplot<-ctrlwpplot
ctrlTFplot$transition<-factor(ctrlTFplot$transition, levels=c('to','from'))
ctrlTFplot <- filter(ctrlTFplot, transition == 'from')
ctrlTFplot <- droplevels(ctrlTFplot)
# Rename the from to oddball / control to concatenate the lists for plotting
TFplot$transition <- as.character(TFplot$transition)
TFplot["transition"][TFplot["transition"] == "from"] <- "oddball"
TFplot$transition <- as.factor(TFplot$transition)
ctrlTFplot$transition <- as.character(ctrlTFplot$transition)
ctrlTFplot["transition"][ctrlTFplot["transition"] == "from"] <- "control"
names(ctrlTFplot)[names(ctrlTFplot) == "ctrlwpplot"] <- "wpplot"
ctrlTFplot$transition <- as.factor(ctrlTFplot$transition)
data <- rbind(TFplot, ctrlTFplot)
transition.labs<- c('Transition from oddballs', 'Transition from controls')
names(transition.labs)<-c('oddball', 'control')
pltTF<-ggplot(data,aes(x=wpplot,y=mean), group=oddballtype)+
geom_line(aes(color=oddballtype), size=1) +
geom_point(aes(color=oddballtype), size=2) +
geom_ribbon(aes(ymin=mean-ci, ymax=mean+ci, fill=oddballtype), alpha=0.2, show.legend = FALSE, inherit.aes=TRUE)+
#geom_errorbar(aes(ymin=mean-se, ymax=mean+se,color=oddballtype), alpha=0.5)+
theme_classic()+
facet_grid(transition~direction, scales='free_x',
labeller=labeller(transition = as_labeller(transition.labs)))+
theme(strip.background = element_blank())+
theme(text=element_text(size=25))+
xlab('Lag') +
ylab('Conditional Response Probability')+
scale_color_manual(values=c('violetred2','turquoise2'),
labels=c('Emotional','Perceptual'), name='Oddball List Type', aesthetics=c('colour','fill'))+
scale_y_continuous(
labels = scales::number_format(accuracy = 0.01))
pltTF
#Compare the averaged (+- 5 lags) transitions to and from the oddballs vs. the control items
CRP_odd_v_ctrl<-read.csv('CRP_avgd_oddballvcontrol.csv')
CRP_odd_v_ctrl<-as.data.frame(CRP_odd_v_ctrl)
CRP_odd_v_ctrl$subject<-as.factor(CRP_odd_v_ctrl$subject)
CRP_odd_v_ctrl$oddballtype<-as.factor(CRP_odd_v_ctrl$oddballtype)
CRP_odd_v_ctrl$transition<-as.factor(CRP_odd_v_ctrl$transition)
CRP_odd_v_ctrl$direction<-as.factor(CRP_odd_v_ctrl$direction)
CRP_odd_v_ctrl$item_type<-as.factor(CRP_odd_v_ctrl$item_type)
transition.labs<- c('Transitions from the target items')
names(transition.labs)<-c('from')
CRP_odd_v_ctrl <- filter(CRP_odd_v_ctrl, transition == 'from')
CRP_odd_v_ctrl <- droplevels(CRP_odd_v_ctrl)
########## 3 way ANOVA #
CRP_odd_v_ctrl$CRPmean <- as.numeric(CRP_odd_v_ctrl$CRPmean)
CRP_odd_v_ctrl$direction <- as.factor(CRP_odd_v_ctrl$direction)
CRP_odd_v_ctrl$oddballtype <- as.factor(CRP_odd_v_ctrl$oddballtype)
CRP_odd_v_ctrl$item_type <- as.factor(CRP_odd_v_ctrl$item_type)
#ggqqplot(CRP_odd_v_ctrl,'CRPmean',ggtheme=theme_bw())+
# facet_grid(oddballtype~item_type+direction, labeller='label_both')
crp.3way <- anova_test(data=CRP_odd_v_ctrl, dv=CRPmean, wid=subject,
within=c(oddballtype,item_type,direction), effect.size = 'pes'
)
get_anova_table(crp.3way)
#post-hoc tests
CRP_odd_v_ctrl %>%
group_by(oddballtype,direction) %>%
pairwise_t_test(CRPmean~item_type, paired=TRUE, p.adjust.method='fdr')
CRP_odd_v_ctrl %>%
group_by(oddballtype,direction) %>%
cohens_d(CRPmean~item_type, paired=TRUE)
###
plt <- CRP_odd_v_ctrl %>%
group_by(oddballtype, item_type, transition, direction) %>%
get_summary_stats(CRPmean, type = 'mean_ci')
pltTF.collapsed<-ggplot(plt,aes(x=direction,y=mean, group=oddballtype, shape= item_type, color = oddballtype,  ymin=mean-ci, ymax=mean+ci))+
geom_pointrange(position=position_dodge2(width=0.5), size=1)+
theme_classic()+
facet_grid(~transition, scales='free_x',
labeller=labeller(transition = as_labeller(transition.labs)))+
theme(text=element_text(size=25))+
theme(strip.background = element_blank())+
xlab('Collapsed Lag (Â± 5 lags)') +
ylab('Conditional Response Probability')+
scale_color_manual(values=c('violetred2','turquoise2'),
labels=c('Emotional','Perceptual'), name='Oddball List Type')+
scale_shape_manual(name = "Item Type",
labels = c("Control", "Oddball"),
values=c(16,17))
pltTF.collapsed
# Run statistics
fwrd <- CRP_odd_v_ctrl
fwrd$CRPmean <- as.numeric(fwrd$CRPmean)
# only select forward transitions as this is what we're interested in
fwrd <- filter(fwrd, direction == 'forwards')
#
fwrd$direction <- as.factor(fwrd$direction)
fwrd$oddballtype <- as.factor(fwrd$oddballtype)
fwrd$item_type <- as.factor(fwrd$item_type)
fwrd <- droplevels(fwrd)
#ggqqplot(fwrd,'CRPmean',ggtheme=theme_bw())+
#facet_grid(oddballtype~item_type, labeller='label_both')
transitions_aov<-anova_test(data=fwrd, dv=CRPmean, wid=subject,
within=c(oddballtype,item_type), effect.size = 'pes'
)
get_anova_table(transitions_aov)
fwrd %>%
group_by(oddballtype) %>%
pairwise_t_test(CRPmean~item_type, paired=TRUE, p.adjust.method='fdr')
fwrd %>%
group_by(oddballtype) %>%
cohens_d(CRPmean~item_type, paired=TRUE)
# For completion check backward transitions
bkwrd <- CRP_odd_v_ctrl
bkwrd$CRPmean <- as.numeric(bkwrd$CRPmean)
# only select forward transitions as this is what we're interested in
bkwrd <- filter(bkwrd, direction == 'backwards')
#
bkwrd$direction <- as.factor(bkwrd$direction)
bkwrd$oddballtype <- as.factor(bkwrd$oddballtype)
bkwrd$item_type <- as.factor(bkwrd$item_type)
bkwrd <- droplevels(bkwrd)
#ggqqplot(bkwrd,'CRPmean',ggtheme=theme_bw())+
# facet_grid(oddballtype~item_type, labeller='label_both')
bckwrd_transitions_aov<-anova_test(data=bkwrd, dv=CRPmean, wid=subject,
within=c(oddballtype,item_type), effect.size = 'pes'
)
get_anova_table(bckwrd_transitions_aov)
bkwrd %>%
group_by(oddballtype) %>%
pairwise_t_test(CRPmean~item_type, paired=TRUE, p.adjust.method='fdr')
bkwrd %>%
group_by(oddballtype) %>%
cohens_d(CRPmean~item_type, paired=TRUE)
get_anova_table(transitions_aov)
get_anova_table(crp.3way)
CRP_odd_v_ctrl %>%
group_by(oddballtype,direction) %>%
pairwise_t_test(CRPmean~item_type, paired=TRUE, p.adjust.method='fdr')
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.factor(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.factor(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
View(data)
levels(data$item_who)
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.numeric(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
# Group data by control words
#control_words <- filter(data, item_who == 'ce' | item_who == 'ctrl_minus_one')
#control_words<-droplevels(control_words)
control_words <- data
control_words_summary <- control_words %>%
group_by(item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
chooseCRANmirror(graphics=FALSE, ind=1)
knitr::opts_chunk$set(echo = TRUE)
#Install all libraries
library(tidyverse)
library(ggpubr)
library(rstatix)
library(rsample)
library(dplyr)
library(ggplot2)
library(data.table)
library(effects)
library(lme4)
library(plyr)
library(emmeans)
library(reshape2)
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.factor(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
emotional_words<-droplevels(emotional_words)
# Run an ANOVA on emotional_words
# data_aov<-anova_test(data=emotional_words, dv=recall, wid=subject,
#                  within=c(word_who,item_who),
#                  )
# get_anova_table(data_aov)
# Try a binomial glm
# glm.emo <- glm(recall~word_who*item_who, family=binomial, data=emotional_words)
# summary(glm.emo)
glmer.emo <- glmer(recall ~ word_who*item_who + (1|subject), family = binomial, data = emotional_words)
summary(glmer.emo)
#
# emotional_words %>%
#   group_by(word_who) %>%
#   pairwise_t_test(recall~item_who, paired=TRUE, p.adjust.method='fdr')
emotional_words$recall <- as.numeric(emotional_words$recall)
emotional_words_summary <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
emotional_words_summary
plt <- ggplot(emotional_words_summary, aes(x=word_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')+
theme(text = element_text(size = 6))
plt
emotional_words_summary <- emotional_words %>%
group_by(item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
plt <- ggplot(emotional_words_summary, aes(x=item_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')
plt
View(emotional_words_summary)
plt
plt <- ggplot(emotional_words_summary, aes(x=word_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')+
theme(text = element_text(size = 6))
plt
emotional_words$recall <- as.numeric(emotional_words$recall)
emotional_words$recall <- as.numeric(emotional_words$recall)
emotional_words_summary <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
emotional_words_summary <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
emotional_words_summary
plt <- ggplot(emotional_words_summary, aes(x=word_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')+
theme(text = element_text(size = 6))
plt
plt
View(emotional_words_summary)
View(emotional_words)
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.factor(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
emotional_words<-droplevels(emotional_words)
View(emotional_words)
emotional_words$recall <- as.numeric(emotional_words$recall)
emotional_words_summary <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
emotional_words_summary
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.factor(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
emotional_words<-droplevels(emotional_words)
rm(list(=ls()))
rm(list(=ls())))
rm(list=ls()))
rm(list=(ls()))
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.factor(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
rm(list=(ls()))
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.numeric(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
emotional_words<-droplevels(emotional_words)
emotional_words_summary <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
emotional_words_summary
plt <- ggplot(emotional_words_summary, aes(x=word_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')+
theme(text = element_text(size = 6))
plt
rm(list=(ls()))
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
data<-read.csv('single_item_emotion.csv')
data$subject <- as.factor(data$subject)
data$recall <- as.numeric(data$recall) # 1 = recalled, 0 = not recalled
data$item_who <- as.factor(data$item_who) #eo = emotional oddball, emo_minus_one (E-1), ce = emotional control, ctrl_minus_one CE-1
data$word_who <- as.factor(data$word_who)
#Group data by emotional words and E-1. Is there an interaction between emotional oddballs x E-1? Yes
emotional_words <- filter(data, item_who == 'eo' | item_who == 'emo_minus_one')
emotional_words<-droplevels(emotional_words)
# Run an ANOVA on emotional_words
# data_aov<-anova_test(data=emotional_words, dv=recall, wid=subject,
#                  within=c(word_who,item_who),
#                  )
# get_anova_table(data_aov)
# Try a binomial glm
# glm.emo <- glm(recall~word_who*item_who, family=binomial, data=emotional_words)
# summary(glm.emo)
#glmer.emo <- glmer(recall ~ word_who*item_who + (1|subject), family = binomial, data = emotional_words)
#summary(glmer.emo)
#
# emotional_words %>%
#   group_by(word_who) %>%
#   pairwise_t_test(recall~item_who, paired=TRUE, p.adjust.method='fdr')
#emotional_words$recall <- as.numeric(emotional_words$recall)
emotional_words_summary <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
emotional_words_summary
plt <- ggplot(emotional_words_summary, aes(x=word_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')+
theme(text = element_text(size = 6))
plt
emotional_words_summary <- emotional_words %>%
group_by(item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
plt <- ggplot(emotional_words_summary, aes(x=item_who, y=mean,fill=item_who)) +
#facet_wrap(~word_who)+
geom_bar(stat='identity', position='dodge')+
ggtitle('Mean amount of recalled emotional and E-1 items')
plt
View(emotional_words_summary)
aov.data <- emotional_words %>%
group_by(word_who) %>%
get_summary_stats(recall, type = 'mean_sd')
View(aov.data)
View(emotional_words)
levels(emotional_words$item_who)
aov <- anova_test(data=aov.data, dv=mean,
between=c(word_who,item_who))
aov.data <- emotional_words %>%
group_by(word_who,item_who) %>%
get_summary_stats(recall, type = 'mean_sd')
aov <- anova_test(data=aov.data, dv=mean,
between=c(word_who,item_who))
aov.data %>% anova_test(recall ~ word_who*item_who)
aov.data %>% anova_test(mean ~ word_who*item_who)
aov <- anova_test(data=aov.data, dv=mean,
between=c(word_who))
get_anova_table(aov)
aov <- anova_test(data=aov.data, dv=mean,
between=c(item_who))
get_anova_table(aov)
aov <- anova_test(data=aov.data, dv=mean,
between=c(item_who))
get_anova_table(aov)
aov <- anova_test(data=aov.data, dv=mean,
between=c(word_who))
get_anova_table(aov)
# No sig. main effect of a word being better recalled than others
hist(data$recall)
library(ggdist)
install.packages('ggdist')
install.packages("ggdist")
library(ggdist)
library(ggdist)
setwd(/private/var/folders/gj/xz0j3hnd6z9gxbs79ply8nm00000gn/T/RtmpZVMzK7/downloaded_packages)
install.packages("ggdist")
install.packages("ggdist")
install.packages("ggdist")
install.packages("ggdist")
library(ggdist)
library(ggdist)
devtools::install_github("mjskay/ggdist")
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
oddballs<-read.csv('oddlists.csv')
oddballs$enc_pos <- as.numeric(oddballs$enc_pos)
oddballs$rec_pos <- as.numeric(oddballs$rec_pos)
oddballs$list_type <- as.factor(oddballs$list_type)
oddballs$subject <- as.factor(oddballs$subject)
oddballs <- drop_na(oddballs) #drop the trials where odd not recalled
chooseCRANmirror(graphics=FALSE, ind=1)
knitr::opts_chunk$set(echo = TRUE)
#Install all libraries
library(tidyverse)
library(ggpubr)
library(rstatix)
library(rsample)
library(dplyr)
library(ggplot2)
library(data.table)
library(effects)
library(lme4)
library(plyr)
library(emmeans)
library(reshape2)
setwd("/Users/albaperis/OneDrive - UAM/PhDUPM_/Von Restroff WP3/Paper_github/Odd_SOA_CRP_Code_Reviewed/PerisYague2023/Raw_Results")
oddballs<-read.csv('oddlists.csv')
oddballs$enc_pos <- as.numeric(oddballs$enc_pos)
oddballs$rec_pos <- as.numeric(oddballs$rec_pos)
oddballs$list_type <- as.factor(oddballs$list_type)
oddballs$subject <- as.factor(oddballs$subject)
oddballs <- drop_na(oddballs) #drop the trials where odd not recalled
controls <- read.csv('ctrlists.csv')
controls$enc_pos <- as.numeric(controls$enc_pos)
controls$rec_pos <- as.numeric(controls$rec_pos)
controls$list_type <- as.factor(controls$list_type)
controls$subject <- as.factor(controls$subject)
controls <- drop_na(controls) #drop the trials where controls not recalled
#Only take trials where the oddballs and controls were encoded in the 7,8,11,12th positions
odd_filt <- filter(oddballs, enc_pos == '7' | enc_pos == '8' | enc_pos == '11' | enc_pos == '12')
ctrl_filt <- filter(controls, enc_pos == '7' | enc_pos == '8' | enc_pos == '11' | enc_pos == '12')
# Plot them sepparately
# Check out oddballs
plt<-ggplot(odd_filt, aes(fill=list_type, x=enc_pos, y=rec_pos, color=list_type))+
geom_jitter()+
scale_y_continuous(breaks=c(0,1,2,3,4,5,6,7, 8, 9, 10, 11, 12, 13, 14))+
scale_x_continuous(breaks=c(7,8,11,12))
# Check out controls
plt<-ggplot(ctrl_filt, aes(fill=list_type, x=enc_pos, y=rec_pos, color=list_type))+
geom_jitter()+
scale_y_continuous(breaks=c(0,1,2,3,4,5,6,7, 8, 9, 10, 11, 12, 13, 14))+
scale_x_continuous(breaks=c(7,8,11,12))
data <- rbind(ctrl_filt, odd_filt)
data_summary <- data %>%
group_by(list_type,item) %>%
get_summary_stats(rec_pos, type='mean_ci')
# data for jitter adding one dot per subject
data.jitter <- data %>%
group_by(list_type,item, subject) %>%
get_summary_stats(rec_pos, type = 'mean_ci')
plot <- ggplot(data_summary, aes(fill=list_type, x=item, y=mean))+
geom_bar(position='dodge', stat='identity')+
geom_errorbar(aes(x=item, ymin=mean-ci, ymax=mean+ci), width=0.4, color='wheat4', size=0.5, position=position_dodge(0.9), stat='identity')+
geom_jitter(data=data.jitter,aes(color=list_type, x=item, y=mean), position=position_jitterdodge(dodge.width = 0.9), show.legend=FALSE, alpha=0.2)+
guides(col=FALSE)+
scale_color_manual(values=c('orchid', 'deepskyblue'))+
scale_fill_manual(values=c('thistle1', 'lightblue1'), labels = c('Emotional', 'Perceptual'), name= 'List Type')+
scale_x_discrete(labels=c('Control', 'Oddball'))+
scale_y_continuous(breaks=c(1,2,3,4,5,6,7, 8, 9, 10, 11, 12, 13, 14))+
labs(x='Item type', y='Output position')+
theme_classic()+
theme(text=element_text(size=25))
plot
data_stats<- data %>%
group_by(subject,item,list_type) %>%
get_summary_stats(rec_pos, type='mean_ci')
data_stats$mean <- as.numeric(data_stats$mean)
data_stats$subject <- as.factor(data_stats$subject)
data_stats$item <- as.factor(data_stats$item)
data_stats$list_type <-as.factor(data_stats$list_type)
output.QQ<-ggqqplot(data_stats,'mean',ggtheme=theme_bw())+
facet_grid(list_type~item, labeller='label_both')
data_stats %>% levene_test(mean ~ list_type*item)
data_aov<-anova_test(data=data_stats, dv=mean, wid=subject,
within=c(list_type,item), effect.size = 'pes',
)
get_anova_table(data_aov)
#write.csv(data_stats,"/output.csv", row.names = FALSE)
